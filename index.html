<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Masky AI - Interview Assistant</title>
    <meta name="description" content="AI-powered interview practice tool with real-time speech recognition">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🎭</text></svg>">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes pulse-ring { 0% { transform: scale(0.95); opacity: 1; } 50% { transform: scale(1.05); opacity: 0.7; } 100% { transform: scale(0.95); opacity: 1; } }
        .pulse-animation { animation: pulse-ring 2s ease-in-out infinite; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .slide-in { animation: slideIn 0.3s ease-out; }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <div id="app"></div>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script type="text/babel">
        const { useState, useRef, useEffect } = React;
        
        function MaskyAI() {
            const [isListening, setIsListening] = useState(false);
            const [transcript, setTranscript] = useState('');
            const [suggestions, setSuggestions] = useState([]);
            const [history, setHistory] = useState([]);
            const [showSettings, setShowSettings] = useState(false);
            const [mode, setMode] = useState('coach'); // 'coach' or 'answer'
            const [settings, setSettings] = useState({ autoListen: true, responseDelay: 2000 });
            const recognitionRef = useRef(null);
            const timeoutRef = useRef(null);

            useEffect(() => {
                if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                    recognitionRef.current = new SpeechRecognition();
                    recognitionRef.current.continuous = true;
                    recognitionRef.current.interimResults = true;
                    recognitionRef.current.lang = 'en-US';

                    recognitionRef.current.onresult = (event) => {
                        let final = '', interim = '';
                        for (let i = event.resultIndex; i < event.results.length; i++) {
                            const text = event.results[i][0].transcript;
                            if (event.results[i].isFinal) final += text + ' ';
                            else interim += text;
                        }
                        setTranscript(final || interim);
                        if (final) {
                            clearTimeout(timeoutRef.current);
                            timeoutRef.current = setTimeout(() => {
                                const responses = mode === 'coach' 
                                    ? getCoachingTips(final.trim())
                                    : getDirectAnswer(final.trim());
                                setHistory(prev => [...prev, { 
                                    question: final.trim(), 
                                    timestamp: new Date().toLocaleTimeString(), 
                                    suggestions: responses,
                                    mode: mode
                                }]);
                                setSuggestions(responses);
                                setTranscript('');
                            }, settings.responseDelay);
                        }
                    };
                    recognitionRef.current.onerror = () => setIsListening(false);
                    recognitionRef.current.onend = () => {
                        if (isListening && settings.autoListen) {
                            try { recognitionRef.current.start(); } catch (e) {}
                        }
                    };
                }
                return () => {
                    if (recognitionRef.current) recognitionRef.current.stop();
                    clearTimeout(timeoutRef.current);
                };
            }, [isListening, settings, mode]);

            const toggleListening = () => {
                if (!recognitionRef.current) {
                    alert('Speech recognition not supported. Use Chrome or Edge.');
                    return;
                }
                if (isListening) {
                    recognitionRef.current.stop();
                    setIsListening(false);
                } else {
                    try {
                        recognitionRef.current.start();
                        setIsListening(true);
                        setTranscript('');
                        setSuggestions([]);
                    } catch (e) {
                        alert('Could not start. Please refresh.');
                    }
                }
            };

            const getDirectAnswer = (question) => {
                const lq = question.toLowerCase();
                
                // Knowledge base with direct answers
                const knowledgeBase = {
                    'what is cybersecurity': {
                        answer: 'Cybersecurity is the practice of protecting systems, networks, and programs from digital attacks. These attacks aim to access, change, or destroy sensitive information, extort money, or interrupt normal business processes. Key areas include network security, application security, information security, operational security, disaster recovery, and end-user education.'
                    },
                    'what is ai': {
                        answer: 'Artificial Intelligence (AI) is the simulation of human intelligence by machines, especially computer systems. AI systems can perform tasks like learning, reasoning, problem-solving, perception, and language understanding. Common applications include machine learning, natural language processing, computer vision, and robotics.'
                    },
                    'what is machine learning': {
                        answer: 'Machine Learning is a subset of AI that enables systems to learn and improve from experience without being explicitly programmed. It uses algorithms to analyze data, identify patterns, and make decisions. Types include supervised learning, unsupervised learning, and reinforcement learning.'
                    },
                    'what is cloud computing': {
                        answer: 'Cloud computing is the delivery of computing services (servers, storage, databases, networking, software) over the internet. Major providers include AWS, Azure, and Google Cloud. Benefits include cost savings, scalability, flexibility, and reduced IT infrastructure management.'
                    }
                };

                // Search for matching topic
                for (const [key, value] of Object.entries(knowledgeBase)) {
                    if (lq.includes(key) || key.includes(lq.replace('what is ', ''))) {
                        return [
                            { type: 'answer', content: value.answer },
                            { type: 'tip', content: 'When answering this in an interview, explain it clearly, give real-world examples, and relate it to the role you\'re applying for.' }
                        ];
                    }
                }

                // If not in knowledge base, provide general guidance
                return [
                    { type: 'info', content: `I don't have a direct answer for "${question}" in my knowledge base yet. In an interview, you would explain this concept clearly with examples.` },
                    { type: 'tip', content: 'Structure your answer: Define the concept → Explain key components → Give real-world examples → Connect to your experience or the role.' }
                ];
            };

            const getCoachingTips = (q) => {
                const lq = q.toLowerCase();
                if (lq.includes('tell me about yourself') || lq.includes('introduce yourself')) {
                    return [
                        { type: 'framework', content: 'Use Present-Past-Future: current role, relevant past experiences, why excited about this opportunity.' },
                        { type: 'example', content: 'I\'m currently a [role] at [company], where I [achievement]. Previously, I [experience] which taught me [skill]. I\'m excited about this role because [alignment].' }
                    ];
                }
                if (lq.includes('weakness') || lq.includes('improvement')) {
                    return [
                        { type: 'framework', content: 'Pick a real weakness not critical to the role, explain improvement actions, show progress.' },
                        { type: 'example', content: 'I struggled with [weakness]. I\'ve been working on it by [actions], and I\'ve seen improvement in [result].' }
                    ];
                }
                if (lq.includes('strength')) {
                    return [
                        { type: 'framework', content: 'Pick 2-3 relevant strengths, provide specific examples with metrics, connect to role requirements.' },
                        { type: 'tip', content: 'Use STAR method: Situation, Task, Action, Result. Be specific with numbers.' }
                    ];
                }
                return [
                    { type: 'framework', content: 'STAR method: Situation, Task, Action, Result with metrics.' },
                    { type: 'tip', content: 'Be specific, use numbers, keep concise (2-3 min), connect to role.' }
                ];
            };

            const exportHistory = () => {
                const data = JSON.stringify(history, null, 2);
                const blob = new Blob([data], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `masky-ai-session-${Date.now()}.json`;
                a.click();
                URL.revokeObjectURL(url);
            };

            return (
                <div className="min-h-screen p-4 md:p-6">
                    <div className="max-w-7xl mx-auto">
                        <div className="bg-white rounded-xl shadow-xl p-6 mb-6">
                            <div className="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                                <div>
                                    <div className="flex items-center gap-3 mb-2">
                                        <div className="gradient-bg p-2 rounded-lg text-white text-2xl">🎭</div>
                                        <div>
                                            <h1 className="text-3xl md:text-4xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent">
                                                Masky AI
                                            </h1>
                                            <div className="flex gap-2 mt-1">
                                                <button
                                                    onClick={() => setMode('coach')}
                                                    className={`text-xs px-3 py-1 rounded-full transition-colors ${
                                                        mode === 'coach' 
                                                            ? 'bg-indigo-600 text-white' 
                                                            : 'bg-gray-200 text-gray-600 hover:bg-gray-300'
                                                    }`}>
                                                    🎓 Coach Mode
                                                </button>
                                                <button
                                                    onClick={() => setMode('answer')}
                                                    className={`text-xs px-3 py-1 rounded-full transition-colors ${
                                                        mode === 'answer' 
                                                            ? 'bg-purple-600 text-white' 
                                                            : 'bg-gray-200 text-gray-600 hover:bg-gray-300'
                                                    }`}>
                                                    💡 Answer Mode
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <p className="text-gray-600">
                                        {mode === 'coach' 
                                            ? 'Get coaching tips on how to answer interview questions' 
                                            : 'Get direct answers to technical questions'}
                                    </p>
                                </div>
                                <button onClick={() => setShowSettings(!showSettings)} className="p-3 hover:bg-gray-100 rounded-lg transition-colors text-xl">
                                    ⚙️
                                </button>
                            </div>
                            {showSettings && (
                                <div className="mt-4 p-4 bg-gray-50 rounded-lg border slide-in">
                                    <h3 className="font-semibold mb-3">Settings</h3>
                                    <label className="flex items-center gap-2 mb-2">
                                        <input type="checkbox" checked={settings.autoListen} 
                                            onChange={(e) => setSettings({...settings, autoListen: e.target.checked})} 
                                            className="rounded" />
                                        <span className="text-sm">Auto-restart listening</span>
                                    </label>
                                    <div>
                                        <label className="text-sm font-medium block mb-1">Response Delay: {settings.responseDelay}ms</label>
                                        <input type="range" min="500" max="5000" step="500" value={settings.responseDelay}
                                            onChange={(e) => setSettings({...settings, responseDelay: parseInt(e.target.value)})} 
                                            className="w-full" />
                                    </div>
                                </div>
                            )}
                        </div>

                        <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <div className="space-y-6">
                                <div className="bg-white rounded-xl shadow-xl p-6">
                                    <h2 className="text-xl font-semibold mb-4">
                                        {mode === 'coach' ? 'Ask Interview Question' : 'Ask Technical Question'}
                                    </h2>
                                    <div className="flex justify-center mb-6">
                                        <button onClick={toggleListening}
                                            className={`p-8 rounded-full transition-all transform hover:scale-105 shadow-2xl text-white ${
                                                isListening ? 'bg-red-500 pulse-animation' : 'gradient-bg'
                                            }`}>
                                            <span className="text-5xl">{isListening ? '🎤' : '🎙️'}</span>
                                        </button>
                                    </div>
                                    <div className="text-center mb-4">
                                        <span className={`inline-flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium ${
                                            isListening ? 'bg-red-100 text-red-800' : 'bg-gray-100 text-gray-800'
                                        }`}>
                                            {isListening && <span className="w-2 h-2 bg-red-600 rounded-full animate-pulse"></span>}
                                            {isListening ? 'Listening...' : 'Click to start'}
                                        </span>
                                    </div>
                                    <div className="bg-gray-50 rounded-lg p-4 min-h-32 border">
                                        <p className="text-gray-700 text-lg">
                                            {transcript || (isListening ? 'Waiting for speech...' : 
                                                mode === 'coach' 
                                                    ? 'Ask: "Tell me about yourself" or other interview questions'
                                                    : 'Ask: "What is cybersecurity?" or other technical questions'
                                            )}
                                        </p>
                                    </div>
                                    <div className="mt-4 text-xs text-gray-500 bg-blue-50 p-3 rounded">
                                        <strong>Current Mode:</strong> {mode === 'coach' ? '🎓 Coach' : '💡 Answer'} 
                                        {mode === 'answer' && ' (Limited knowledge base - add backend for full AI)'}
                                    </div>
                                </div>

                                {suggestions.length > 0 && (
                                    <div className="bg-white rounded-xl shadow-xl p-6 slide-in">
                                        <h2 className="text-xl font-semibold mb-4 flex items-center gap-2">
                                            <span className="text-2xl">{mode === 'coach' ? '💡' : '📚'}</span> 
                                            {mode === 'coach' ? 'Coaching Tips' : 'Answer'}
                                        </h2>
                                        <div className="space-y-3">
                                            {suggestions.map((s, i) => (
                                                <div key={i} className={`p-4 rounded-lg border ${
                                                    s.type === 'answer' 
                                                        ? 'bg-gradient-to-r from-purple-50 to-pink-50 border-purple-200'
                                                        : 'bg-gradient-to-r from-indigo-50 to-blue-50 border-indigo-200'
                                                }`}>
                                                    <span className={`inline-block px-2 py-1 text-white text-xs font-bold rounded uppercase mb-2 ${
                                                        s.type === 'answer' ? 'bg-purple-600' : 'bg-indigo-600'
                                                    }`}>
                                                        {s.type}
                                                    </span>
                                                    <p className="text-gray-700 leading-relaxed">{s.content}</p>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}
                            </div>

                            <div className="bg-white rounded-xl shadow-xl p-6">
                                <div className="flex justify-between items-center mb-4">
                                    <h2 className="text-xl font-semibold">History</h2>
                                    {history.length > 0 && (
                                        <div className="flex gap-2">
                                            <button onClick={exportHistory} className="px-3 py-2 text-indigo-600 hover:bg-indigo-50 rounded-lg text-sm transition-colors">
                                                📥 Export
                                            </button>
                                            <button onClick={() => setHistory([])} className="px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg text-sm transition-colors">
                                                🗑️ Clear
                                            </button>
                                        </div>
                                    )}
                                </div>
                                <div className="space-y-4 max-h-[700px] overflow-y-auto">
                                    {history.length === 0 ? (
                                        <div className="text-center py-12 text-gray-400">
                                            <div className="text-5xl mb-3">💬</div>
                                            <p>Start asking questions to see history</p>
                                        </div>
                                    ) : (
                                        history.map((entry, idx) => (
                                            <div key={idx} className="border rounded-lg p-4 hover:shadow-md transition-shadow slide-in">
                                                <div className="flex justify-between items-start mb-2">
                                                    <span className="text-xs text-gray-500">{entry.timestamp}</span>
                                                    <span className={`text-xs px-2 py-1 rounded ${
                                                        entry.mode === 'coach' ? 'bg-indigo-100 text-indigo-700' : 'bg-purple-100 text-purple-700'
                                                    }`}>
                                                        {entry.mode === 'coach' ? '🎓 Coach' : '💡 Answer'}
                                                    </span>
                                                </div>
                                                <div className="mt-2 mb-3">
                                                    <p className="font-medium text-gray-800 mb-1">Question:</p>
                                                    <p className="text-gray-700 bg-gray-50 p-2 rounded">{entry.question}</p>
                                                </div>
                                                <div>
                                                    <p className="font-medium text-gray-800 mb-2 text-sm">
                                                        {entry.mode === 'coach' ? 'Coaching Tips:' : 'Answer:'}
                                                    </p>
                                                    <div className="space-y-2">
                                                        {entry.suggestions.map((sugg, sidx) => (
                                                            <div key={sidx} className="text-sm bg-indigo-50 p-2 rounded border-l-2 border-indigo-400">
                                                                <span className="font-bold text-indigo-700 uppercase text-xs">{sugg.type}:</span>
                                                                <p className="text-gray-700 mt-1">{sugg.content}</p>
                                                            </div>
                                                        ))}
                                                    </div>
                                                </div>
                                            </div>
                                        ))
                                    )}
                                </div>
                            </div>
                        </div>

                        <div className="mt-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                            <p className="text-sm text-yellow-800">
                                <strong>Note:</strong> {mode === 'coach' 
                                    ? 'Coach mode helps you learn HOW to answer interview questions using proven frameworks.' 
                                    : 'Answer mode has a limited built-in knowledge base. For unlimited AI-powered answers, deploy the backend with GPT-4.'}
                            </p>
                        </div>

                        <div className="mt-4 text-center text-gray-600 text-sm">
                            <p>Built with ❤️ for interview success</p>
                            <p className="mt-1">
                                <a href="https://github.com/Lightiam/Masky-AI" target="_blank" rel="noopener noreferrer" className="text-indigo-600 hover:underline">
                                    ⭐ Star on GitHub
                                </a>
                            </p>
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.createRoot(document.getElementById('app')).render(<MaskyAI />);
    </script>
</body>
</html>
