<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Masky AI - Interview Assistant</title>
    <meta name="description" content="AI-powered interview practice tool with real-time speech recognition">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üé≠</text></svg>">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes pulse-ring { 0% { transform: scale(0.95); opacity: 1; } 50% { transform: scale(1.05); opacity: 0.7; } 100% { transform: scale(0.95); opacity: 1; } }
        .pulse-animation { animation: pulse-ring 2s ease-in-out infinite; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .slide-in { animation: slideIn 0.3s ease-out; }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <div id="app"></div>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script type="text/babel">
        const { useState, useRef, useEffect } = React;
        
        function MaskyAI() {
            const [isListening, setIsListening] = useState(false);
            const [transcript, setTranscript] = useState('');
            const [suggestions, setSuggestions] = useState([]);
            const [history, setHistory] = useState([]);
            const [showSettings, setShowSettings] = useState(false);
            const [settings, setSettings] = useState({ autoListen: true, responseDelay: 2000 });
            const recognitionRef = useRef(null);
            const timeoutRef = useRef(null);

            useEffect(() => {
                if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                    recognitionRef.current = new SpeechRecognition();
                    recognitionRef.current.continuous = true;
                    recognitionRef.current.interimResults = true;
                    recognitionRef.current.lang = 'en-US';

                    recognitionRef.current.onresult = (event) => {
                        let final = '', interim = '';
                        for (let i = event.resultIndex; i < event.results.length; i++) {
                            const text = event.results[i][0].transcript;
                            if (event.results[i].isFinal) final += text + ' ';
                            else interim += text;
                        }
                        setTranscript(final || interim);
                        if (final) {
                            clearTimeout(timeoutRef.current);
                            timeoutRef.current = setTimeout(() => {
                                const responses = getSmartResponses(final.trim());
                                setHistory(prev => [...prev, { question: final.trim(), timestamp: new Date().toLocaleTimeString(), suggestions: responses }]);
                                setSuggestions(responses);
                                setTranscript('');
                            }, settings.responseDelay);
                        }
                    };
                    recognitionRef.current.onerror = () => setIsListening(false);
                    recognitionRef.current.onend = () => {
                        if (isListening && settings.autoListen) {
                            try { recognitionRef.current.start(); } catch (e) {}
                        }
                    };
                }
                return () => {
                    if (recognitionRef.current) recognitionRef.current.stop();
                    clearTimeout(timeoutRef.current);
                };
            }, [isListening, settings]);

            const toggleListening = () => {
                if (!recognitionRef.current) {
                    alert('Speech recognition not supported. Use Chrome or Edge.');
                    return;
                }
                if (isListening) {
                    recognitionRef.current.stop();
                    setIsListening(false);
                } else {
                    try {
                        recognitionRef.current.start();
                        setIsListening(true);
                        setTranscript('');
                        setSuggestions([]);
                    } catch (e) {
                        alert('Could not start. Please refresh.');
                    }
                }
            };

            const getSmartResponses = (q) => {
                const lq = q.toLowerCase();
                if (lq.includes('tell me about yourself') || lq.includes('introduce yourself')) {
                    return [
                        { type: 'framework', content: 'Use Present-Past-Future: current role, relevant past experiences, why excited about this opportunity.' },
                        { type: 'example', content: 'I\'m currently a [role] at [company], where I [achievement]. Previously, I [experience] which taught me [skill]. I\'m excited about this role because [alignment].' }
                    ];
                }
                if (lq.includes('weakness') || lq.includes('improvement')) {
                    return [
                        { type: 'framework', content: 'Pick a real weakness not critical to the role, explain improvement actions, show progress.' },
                        { type: 'example', content: 'I struggled with [weakness]. I\'ve been working on it by [actions], and I\'ve seen improvement in [result].' }
                    ];
                }
                if (lq.includes('strength')) {
                    return [
                        { type: 'framework', content: 'Pick 2-3 relevant strengths, provide specific examples with metrics, connect to role requirements.' },
                        { type: 'tip', content: 'Use STAR method: Situation, Task, Action, Result. Be specific with numbers.' }
                    ];
                }
                if (lq.includes('why') && (lq.includes('company') || lq.includes('here'))) {
                    return [
                        { type: 'framework', content: 'Mention specific company initiatives, culture, or recent news. Connect to career goals.' },
                        { type: 'tip', content: 'Reference specific projects or values. Show you\'ve done homework.' }
                    ];
                }
                if (lq.includes('conflict') || lq.includes('disagreement') || lq.includes('difficult')) {
                    return [
                        { type: 'framework', content: 'STAR method: Describe objectively, explain resolution approach, focus on positive outcome.' },
                        { type: 'tip', content: 'Emphasize communication, empathy, problem-solving. Show emotional intelligence.' }
                    ];
                }
                if (lq.includes('where do you see yourself') || lq.includes('5 years')) {
                    return [
                        { type: 'framework', content: 'Focus on skill development and increasing responsibility. Align with company trajectory.' },
                        { type: 'example', content: 'I see myself deepening expertise in [area], taking on leadership, contributing to [goal].' }
                    ];
                }
                return [
                    { type: 'framework', content: 'STAR method: Situation, Task, Action, Result with metrics.' },
                    { type: 'tip', content: 'Be specific, use numbers, keep concise (2-3 min), connect to role.' }
                ];
            };

            const exportHistory = () => {
                const data = JSON.stringify(history, null, 2);
                const blob = new Blob([data], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `masky-ai-session-${Date.now()}.json`;
                a.click();
                URL.revokeObjectURL(url);
            };

            return (
                <div className="min-h-screen p-4 md:p-6">
                    <div className="max-w-7xl mx-auto">
                        <div className="bg-white rounded-xl shadow-xl p-6 mb-6">
                            <div className="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                                <div>
                                    <div className="flex items-center gap-3 mb-2">
                                        <div className="gradient-bg p-2 rounded-lg text-white text-2xl">üé≠</div>
                                        <h1 className="text-3xl md:text-4xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent">
                                            Masky AI
                                        </h1>
                                    </div>
                                    <p className="text-gray-600">AI-powered interview practice companion</p>
                                </div>
                                <button onClick={() => setShowSettings(!showSettings)} className="p-3 hover:bg-gray-100 rounded-lg transition-colors text-xl">
                                    ‚öôÔ∏è
                                </button>
                            </div>
                            {showSettings && (
                                <div className="mt-4 p-4 bg-gray-50 rounded-lg border slide-in">
                                    <h3 className="font-semibold mb-3">Settings</h3>
                                    <label className="flex items-center gap-2 mb-2">
                                        <input type="checkbox" checked={settings.autoListen} 
                                            onChange={(e) => setSettings({...settings, autoListen: e.target.checked})} 
                                            className="rounded" />
                                        <span className="text-sm">Auto-restart listening</span>
                                    </label>
                                    <div>
                                        <label className="text-sm font-medium block mb-1">Response Delay: {settings.responseDelay}ms</label>
                                        <input type="range" min="500" max="5000" step="500" value={settings.responseDelay}
                                            onChange={(e) => setSettings({...settings, responseDelay: parseInt(e.target.value)})} 
                                            className="w-full" />
                                    </div>
                                </div>
                            )}
                        </div>

                        <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <div className="space-y-6">
                                <div className="bg-white rounded-xl shadow-xl p-6">
                                    <h2 className="text-xl font-semibold mb-4">Live Transcription</h2>
                                    <div className="flex justify-center mb-6">
                                        <button onClick={toggleListening}
                                            className={`p-8 rounded-full transition-all transform hover:scale-105 shadow-2xl text-white ${
                                                isListening ? 'bg-red-500 pulse-animation' : 'gradient-bg'
                                            }`}>
                                            <span className="text-5xl">{isListening ? 'üé§' : 'üéôÔ∏è'}</span>
                                        </button>
                                    </div>
                                    <div className="text-center mb-4">
                                        <span className={`inline-flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium ${
                                            isListening ? 'bg-red-100 text-red-800' : 'bg-gray-100 text-gray-800'
                                        }`}>
                                            {isListening && <span className="w-2 h-2 bg-red-600 rounded-full animate-pulse"></span>}
                                            {isListening ? 'Listening...' : 'Click to start'}
                                        </span>
                                    </div>
                                    <div className="bg-gray-50 rounded-lg p-4 min-h-32 border">
                                        <p className="text-gray-700 text-lg">
                                            {transcript || (isListening ? 'Waiting for speech...' : 'Click microphone to begin')}
                                        </p>
                                    </div>
                                </div>

                                {suggestions.length > 0 && (
                                    <div className="bg-white rounded-xl shadow-xl p-6 slide-in">
                                        <h2 className="text-xl font-semibold mb-4 flex items-center gap-2">
                                            <span className="text-2xl">üí°</span> Smart Suggestions
                                        </h2>
                                        <div className="space-y-3">
                                            {suggestions.map((s, i) => (
                                                <div key={i} className="p-4 bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg border border-indigo-200">
                                                    <span className="inline-block px-2 py-1 bg-indigo-600 text-white text-xs font-bold rounded uppercase mb-2">
                                                        {s.type}
                                                    </span>
                                                    <p className="text-gray-700 leading-relaxed">{s.content}</p>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}
                            </div>

                            <div className="bg-white rounded-xl shadow-xl p-6">
                                <div className="flex justify-between items-center mb-4">
                                    <h2 className="text-xl font-semibold">Conversation History</h2>
                                    {history.length > 0 && (
                                        <div className="flex gap-2">
                                            <button onClick={exportHistory} className="px-3 py-2 text-indigo-600 hover:bg-indigo-50 rounded-lg text-sm transition-colors flex items-center gap-1">
                                                üì• Export
                                            </button>
                                            <button onClick={() => setHistory([])} className="px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg text-sm transition-colors flex items-center gap-1">
                                                üóëÔ∏è Clear
                                            </button>
                                        </div>
                                    )}
                                </div>
                                <div className="space-y-4 max-h-[700px] overflow-y-auto">
                                    {history.length === 0 ? (
                                        <div className="text-center py-12 text-gray-400">
                                            <div className="text-5xl mb-3">üí¨</div>
                                            <p>Start listening to see your interview history</p>
                                        </div>
                                    ) : (
                                        history.map((entry, idx) => (
                                            <div key={idx} className="border rounded-lg p-4 hover:shadow-md transition-shadow slide-in">
                                                <span className="text-xs text-gray-500">{entry.timestamp}</span>
                                                <div className="mt-2 mb-3">
                                                    <p className="font-medium text-gray-800 mb-1">Question:</p>
                                                    <p className="text-gray-700 bg-gray-50 p-2 rounded">{entry.question}</p>
                                                </div>
                                                <div>
                                                    <p className="font-medium text-gray-800 mb-2 text-sm">Suggestions:</p>
                                                    <div className="space-y-2">
                                                        {entry.suggestions.map((sugg, sidx) => (
                                                            <div key={sidx} className="text-sm bg-indigo-50 p-2 rounded border-l-2 border-indigo-400">
                                                                <span className="font-bold text-indigo-700 uppercase text-xs">{sugg.type}:</span>
                                                                <p className="text-gray-700 mt-1">{sugg.content}</p>
                                                            </div>
                                                        ))}
                                                    </div>
                                                </div>
                                            </div>
                                        ))
                                    )}
                                </div>
                            </div>
                        </div>

                        <div className="mt-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                            <p className="text-sm text-yellow-800">
                                <strong>Ethical Use Notice:</strong> This tool is designed for interview preparation and practice. Using AI assistance during actual interviews without disclosure may violate policies and ethical guidelines.
                            </p>
                        </div>

                        <div className="mt-4 text-center text-gray-600 text-sm">
                            <p>Built with ‚ù§Ô∏è for interview success</p>
                            <p className="mt-1">
                                <a href="https://github.com/Lightiam/Masky-AI" target="_blank" rel="noopener noreferrer" className="text-indigo-600 hover:underline">
                                    ‚≠ê Star on GitHub
                                </a>
                            </p>
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.createRoot(document.getElementById('app')).render(<MaskyAI />);
    </script>
</body>
</html>
